<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YT Music</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui;background:#0b0b0b;color:#fff}
header{
  display:flex;gap:10px;align-items:center;
  padding:12px;background:#141414;position:sticky;top:0;z-index:10
}
.logo{color:red;font-weight:700;font-size:18px}

/* SEARCH BAR */
.search-box{
  flex:1;display:flex;gap:6px
}
.search-box input{
  flex:1;padding:10px;background:#000;color:#fff;
  border:1px solid #333;border-radius:8px
}
.search-box button{
  padding:10px 14px;border:none;border-radius:8px;
  background:red;color:#fff;font-size:14px
}

/* PLAYER */
.player-container{
  max-width:900px;margin:14px auto;
  aspect-ratio:16/9;border-radius:16px;
  overflow:hidden;display:none
}
.player-container iframe{width:100%;height:100%}

/* MINI PLAYER */
.player-container.mini{
  position:fixed;bottom:90px;right:16px;
  width:260px;aspect-ratio:16/9;
  z-index:50;cursor:move;
  box-shadow:0 0 18px rgba(0,0,0,.8)
}

/* FEED */
.feed{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:14px;padding:12px
}
.card{
  background:#141414;border:1px solid #2a2a2a;
  border-radius:14px;padding:8px;cursor:pointer
}
.card img{width:100%;border-radius:10px}
.card span{display:block;font-size:13px;margin-top:6px}

/* SEARCH PAGE */
.search-page{padding:12px}
.search-results{margin-top:10px}

/* NAV */
nav{
  position:fixed;bottom:0;left:0;right:0;
  display:flex;justify-content:space-around;
  background:#111;padding:14px 0
}
nav button{
  background:none;border:none;color:#fff;
  font-size:14px;display:flex;
  flex-direction:column;align-items:center
}

.hidden{display:none}
.spacer{height:120px}
</style>
</head>

<body>

<header>
  <div class="logo">YT Music</div>
  <div class="search-box">
    <input id="searchInput" placeholder="Search songs‚Ä¶">
    <button onclick="goSearch()">Search</button>
  </div>
</header>

<!-- PLAYER -->
<div id="playerBox" class="player-container">
  <iframe id="player"
    allow="autoplay; encrypted-media"
    allowfullscreen></iframe>
</div>

<!-- HOME -->
<div id="homePage" class="feed"></div>

<!-- SEARCH PAGE -->
<div id="searchPage" class="search-page hidden">
  <div id="searchResults" class="feed"></div>
</div>

<div class="spacer"></div>

<nav>
  <button onclick="navigate('home')">üè†<span>Home</span></button>
  <button onclick="goSearch()">üîç<span>Search</span></button>
</nav>

<script>
/* ================= CONFIG ================= */
const API_KEY = "AIzaSyDegWP6p4oz6QHaKe55UHE50KGbviyycfU";
const ORIGIN = location.origin;

/* ================= ELEMENTS ================= */
const playerBox = document.getElementById("playerBox");
const player = document.getElementById("player");
const homePage = document.getElementById("homePage");
const searchPage = document.getElementById("searchPage");
const searchResults = document.getElementById("searchResults");

/* ================= STATE ================= */
let currentVideo = null;
let nextPageToken = "";

/* ================= ROUTER ================= */
function navigate(page, data=null, push=true){
  if(push){
    history.pushState({page,data}, "", page==="home"?"#home":page==="search"?`#search?q=${data||""}`:`#watch=${data}`);
  }

  homePage.classList.add("hidden");
  searchPage.classList.add("hidden");

  if(page==="home"){
    homePage.classList.remove("hidden");
    loadHome();
  }

  if(page==="search"){
    searchPage.classList.remove("hidden");
    loadSearch(data);
    if(currentVideo) makeMini();
  }

  if(page==="watch"){
    playVideo(data,false);
  }
}

window.onpopstate = e=>{
  if(!e.state) return navigate("home",null,false);
  navigate(e.state.page, e.state.data, false);
};

/* ================= PLAYER ================= */
function playVideo(videoId, push=true){
  if(!videoId) return;
  currentVideo = videoId;

  playerBox.style.display="block";
  playerBox.classList.remove("mini");

  player.src =
    `https://www.youtube-nocookie.com/embed/${videoId}`+
    `?autoplay=1&rel=0&modestbranding=1&origin=${ORIGIN}`;

  if(push) navigate("watch", videoId);
}

function makeMini(){
  playerBox.classList.add("mini");
}

/* ================= DRAG MINI ================= */
let drag=false,dx=0,dy=0;
playerBox.addEventListener("mousedown",e=>{
  if(!playerBox.classList.contains("mini")) return;
  drag=true;
  dx=e.clientX-playerBox.offsetLeft;
  dy=e.clientY-playerBox.offsetTop;
});
window.addEventListener("mousemove",e=>{
  if(!drag) return;
  playerBox.style.left=(e.clientX-dx)+"px";
  playerBox.style.top=(e.clientY-dy)+"px";
});
window.addEventListener("mouseup",()=>drag=false);

/* ================= DATA ================= */
function videoId(item){
  if(!item||!item.id) return null;
  if(typeof item.id==="string") return item.id;
  return item.id.videoId;
}

function loadHome(){
  homePage.innerHTML="";
  fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet&chart=mostPopular&regionCode=IN&videoCategoryId=10&maxResults=12&key=${API_KEY}`)
  .then(r=>r.json())
  .then(d=>{
    d.items.forEach(item=>{
      const id = videoId(item);
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${item.snippet.thumbnails.medium.url}"><span>${item.snippet.title}</span>`;
      c.onclick=()=>playVideo(id);
      homePage.appendChild(c);
    });
  });
}

function loadSearch(q){
  searchResults.innerHTML="";
  if(!q) return;

  fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&q=${encodeURIComponent(q)}&maxResults=12&key=${API_KEY}`)
  .then(r=>r.json())
  .then(d=>{
    d.items.forEach(item=>{
      const id = videoId(item);
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${item.snippet.thumbnails.medium.url}"><span>${item.snippet.title}</span>`;
      c.onclick=()=>playVideo(id);
      searchResults.appendChild(c);
    });
  });
}

/* ================= SEARCH ================= */
function goSearch(){
  const q=document.getElementById("searchInput").value.trim();
  navigate("search", q);
}

/* INIT */
navigate("home",null,false);
</script>

</body>
</html>
